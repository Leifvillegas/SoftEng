<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Your Trips</title>
</head>
<body>

<h1>Your Trips</h1>

<p th:if="${error}" th:text="${error}" style="color:red;"></p>

<form th:action="@{/trips(userId=${userId})}" th:object="${trip}" method="post">

    <label>Destination:</label>
    <select th:field="*{destination.id}">
        <form th:action="@{/trips(userId=${userId})}" th:object="${trip}" method="post">

        <label>Title:</label>
        <input type="text" th:field="*{title}" required>
        <br><br>

        <label>Destination:</label>
        <select th:field="*{destination.id}">
            <option value="">-- Select Destination --</option>
            <option th:each="d : ${destinations}"
                    th:value="${d.id}"
                    th:text="${d.name + ' (' + d.country + ')'}">
            </option>
        </select>
        <br><br>

        <label>Start Date:</label>
        <input type="date" th:field="*{startDate}">
        <br><br>

        <label>End Date:</label>
        <input type="date" th:field="*{endDate}">
        <br><br>

        <label>Notes:</label>
        <input type="text" th:field="*{notes}">
        <br><br>

        <button type="submit">Create Trip</button>
    </form>

        <hr>

<h2>Existing Trips</h2>

<table border="1" cellpadding="5" th:if="${!#lists.isEmpty(trips)}">
    <thead>
    <tr>
        <th>ID</th>
        <th>Destination</th>
        <th>Start</th>
        <th>End</th>
        <th>Notes</th>
        <th>Delete</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="t : ${trips}">
        <td th:text="${t.id}"></td>
        <td th:text="${t.destination != null ? t.destination.name : 'N/A'}"></td>
        <td th:text="${t.startDate}"></td>
        <td th:text="${t.endDate}"></td>
        <td th:text="${t.notes}"></td>
        <td>
            <form th:action="@{/trips/delete(userId=${userId})}" method="post">
                <input type="hidden" name="id" th:value="${t.id}">
                <button type="submit">Delete</button>
            </form>
        </td>
    </tr>
    </tbody>
</table>

<p th:if="${#lists.isEmpty(trips)}">No trips found.</p>

<br>

<a href="/">Home</a>
<a href="/destinations">View Destinations</a>

</body>
</html>
